# OnecPDF / MaisPDF

Библиотека для создания PDF-документов из .NET или через COM-интерфейс. Основная цель проекта — предоставить компоненту для использования в системе **1С:Предприятие**. Библиотека построена на PDFsharp и MigraDoc.

## Состав проекта
- **MaisPDF** — библиотека с классами `Документ` и `Страница` для работы с PDF.
- **PDFTest** — пример консольного приложения, демонстрирующий использование библиотеки.

## Быстрый старт
```csharp
var doc = new Документ();
if (doc.Создать())
{
    var page = doc.НоваяСтраница(210, 297); // размеры в мм
    page.НачатьОтрисовку();
    page.УстановитьШрифт("OpenSans", 12, 0);
    page.Текст("Пример", 10, 10, 50, 10, 1);
    page.ЗавершитьОтрисовку();
    doc.СохранитьФайл("example.pdf");
}
```

## Методы `Документ`
| Метод | Назначение |
|-------|------------|
| `ВключитьОтладку()` | Включить режим отрисовки вспомогательных рамок. |
| `ВыключитьОтладку()` | Отключить режим отладки. |
| `ПолучитьОшибку()` | Последнее сообщение об ошибке. |
| `КоличествоСтраниц()` | Возвращает число страниц в документе. |
| `ЗащититьДокумент(string password)` | Устанавливает пароль на открытие документа. |
| `Создать()` | Создать новый документ. |
| `СоздатьИзШаблона(byte[] templateContent)` | Создать документ из PDF‑шаблона. |
| `НоваяСтраница(double width, double height)` | Добавить новую страницу указанного размера (мм). |
| `ПолучитьСтраницу(int pageNumber)` | Получить существующую страницу. |
| `ДобавитьСтраницуИзШаблона(byte[] templateContent)` | Добавить страницу из PDF‑шаблона (не реализовано). |
| `СохранитьФайл(string path)` | Сохранить документ в файл. |
| `СохранитьБайтМассив()` | Получить содержимое документа в виде массива байтов. |

## Методы `Страница`
| Метод | Назначение |
|-------|------------|
| `НачатьОтрисовку()` | Подготовить страницу к рисованию. |
| `ЗавершитьОтрисовку()` | Завершить рисование. |
| `ШиринаСтраницы()` | Ширина страницы в пунктах. |
| `ВысотаСтраницы()` | Высота страницы в пунктах. |
| `УстановитьШрифт(string name, double size, int style)` | Задать текущий шрифт. |
| `УстановитьЦветCMYK(double c, double m, double y, double k)` | Задать цвет в модели CMYK. |
| `УстановитьЦветRGB(int r, int g, int b)` | Задать цвет в RGB. |
| `Текст(string text, double left, double top, double width, double height, int align)` | Нарисовать текст. |
| `Штрихкод(string value, double left, double top, double width, double height)` | Нарисовать штрихкод EAN‑13. |
| `QRКод(string value, double left, double top, double scale, int version)` | Нарисовать QR‑код. |
| `ЗаполненныйПрямоугольник(double left, double top, double width, double height)` | Заполнить прямоугольную область. |
| `Прямоугольник(double left, double top, double width, double height, double penWidth)` | Нарисовать прямоугольник. |
| `Линия(double x1, double y1, double x2, double y2, double width)` | Нарисовать линию. |
| `ЗагрузитьВекторноеИзображение(byte[] data)` | Загрузить изображение из векторного файла (например, SVG/PDF). |
| `ЗагрузитьРастовоеИзображение(byte[] data)` | Загрузить растровое изображение. |
| `ШиринаИзображения()` | Текущая ширина загруженного изображения. |
| `ВысотаИзображения()` | Текущая высота загруженного изображения. |
| `Изображение(double left, double top)` | Вывести изображение в натуральном размере. |
| `ИзображениеВписать(double left, double top, double width, double height)` | Вписать изображение в прямоугольник. |
| `ИзображениеЦентр(double left, double top, double width, double height)` | Центрировать изображение в прямоугольнике. |

